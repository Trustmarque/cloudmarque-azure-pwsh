service:
  dependencies:
    keyvault:
    appInsights:                                        # Required to enable app insights on webapp
  publish:
    resourceGroup:
    appServicePlan:
    webapp:
    apiManagement:
    frontDoor:
    frontdoorResourceGroup:
    cdn:
    endpoint:
    slot:

webSolutions:
  - name:
    service:
          publish:
            resourceGroup:
    appServicePlans:
      - name: serviceplan1
        service:
          publish:
            appServicePlan:
        sku: S1
        region: East US
        webapps:
          - name: Exampleapp1s
            region:                                                 # Default to app serviceplan region
            backendpool: mainExampleBackend
            enableAppInsight: false                                 # Optional - Default is false. True requires service dependency - appInsights
            backendHostHeader: false                                # Optional - Default is true. Required for easy auth scenarios
            weight:                                                 # Optional
            priority:                                               # Optional
            runTime: TOMCAT|9.0-jre8                                # Only Linux supported
            service:
              publish:
                webapp:
            slots:
              - name: Production
                service:
                  publish:
                    slot:
              - name: Staging
                service:
                  publish:
                    slot:
            contentDeliveryNetwork:
              name:
              sku:
              service:
                publish:
                  cdn:
                  endpoint:
          - name: Exampleapp2s
            region:                                                 # Default to app serviceplan region
            backendpool: mainExampleBackend
            enableAppInsight: false                                 # Optional - Default is false. True requires service dependency - appInsights
            backendHostHeader: false                                # Optional - Default is true. Required for easy auth scenarios
            weight:                                                 # Optional
            priority:                                               # Optional
            runTime: TOMCAT|9.0-jre8                                # Only Linux supported
            service:
              publish:
                webapp:
            slots:
              - Production
              - staging

    apiManagementServices:
      - name:
        region:                                                     # Optional - Defaults to global location
        service:
          publish:
            apiManagement:
        publisherName:
        publisherEmail:
        sku:
        skuCount:                                                   # Optional - Default is 1
        backendpool: APIExampleBackend
        backendHostHeader: false                                    # Optional - Default is true. Required for easy auth scenarios
        weight:                                                     # Optional
        priority:                                                   # Optional


frontDoor:
  name: ExampleFrontdoor
  sessionAffinity:                                                  # Optional - leave empty or false for disabled
  service:
    dependencies:
      webApplicationFirewallPolicy:                                 # Optional - Provide cm-service tag of frontdoor firewall policy
    publish:
      frontdoor:
      frontdoorResourceGroup:
  customDomains:
    - domainName: customdomain1
      enableHttps: true                                             # Optional - Default is false
      service:
        dependencies:
          keyvault:                                                 # Optional - leave empty for Azure provided certificate
          webApplicationFirewallPolicy:                             # Optional - Provide cm-service tag of frontdoor firewall policy
      customCertificateSecretName:                                  # Optional - leave empty for Azure provided certificate
      sessionAffinity:                                              # Optional - true / false - False is Default
  backEndPools:
    - name: mainExampleBackend
      healthCheckPath:                                              # Optional - Default is index.html
      protocol: Https                                               # Optional - Default is Https
    - name: APIExampleBackend
      healthCheckPath: /api.html
  rules:
    - name: Examplerule1
      pattern:
        - /*                                                        # Mandatory for atleast one routing rule
        - /all
      backEndPoolname: mainExampleBackend
      acceptedProtocols:                                            # Optional: Default is both http and https
        - https
      endpoints:                                                    # Optional - For Domain based routing
        - customdomain1
      enableCaching: true                                           # Optional - Default is false
    - name: Examplerule2
      pattern:
        - /api
      backEndPoolname: APIExampleBackend
